class Pacman{constructor(a,b,c,d,e){this.x=a,this.y=b,this.width=c,this.height=d,this.speed=e,this.direction=4,this.nextDirection=4,this.frameCount=7,this.currentFrame=1,setInterval(()=>{this.changeAnimation()},100)}moveProcess(){if(this.changeDirectionIfPossible(),this.moveForwards(),this.checkCollisions())return void this.moveBackwards()}eat(){for(let a=0;a<map.length;a++)for(let b=0;b<map[0].length;b++)2==map[a][b]&&this.getMapX()==b&&this.getMapY()==a&&(map[a][b]=3,score++)}moveBackwards(){switch(this.direction){case DIRECTION_RIGHT:this.x-=this.speed;break;case DIRECTION_UP:this.y+=this.speed;break;case DIRECTION_LEFT:this.x+=this.speed;break;case DIRECTION_BOTTOM:this.y-=this.speed;}}moveForwards(){switch(this.direction){case DIRECTION_RIGHT:this.x+=this.speed;break;case DIRECTION_UP:this.y-=this.speed;break;case DIRECTION_LEFT:this.x-=this.speed;break;case DIRECTION_BOTTOM:this.y+=this.speed;}}checkCollisions(){let a=!1;return(1==map[parseInt(this.y/oneBlockSize)][parseInt(this.x/oneBlockSize)]||1==map[parseInt(this.y/oneBlockSize+.9999)][parseInt(this.x/oneBlockSize)]||1==map[parseInt(this.y/oneBlockSize)][parseInt(this.x/oneBlockSize+.9999)]||1==map[parseInt(this.y/oneBlockSize+.9999)][parseInt(this.x/oneBlockSize+.9999)])&&(a=!0),a}checkGhostCollision(a){for(let b,c=0;c<a.length;c++)if(b=a[c],b.getMapX()==this.getMapX()&&b.getMapY()==this.getMapY())return!0;return!1}changeDirectionIfPossible(){if(this.direction!=this.nextDirection){let a=this.direction;this.direction=this.nextDirection,this.moveForwards(),this.checkCollisions()?(this.moveBackwards(),this.direction=a):this.moveBackwards()}}getMapX(){let a=parseInt(this.x/oneBlockSize);return a}getMapY(){let a=parseInt(this.y/oneBlockSize);return a}getMapXRightSide(){let a=parseInt((.99*this.x+oneBlockSize)/oneBlockSize);return a}getMapYRightSide(){let a=parseInt((.99*this.y+oneBlockSize)/oneBlockSize);return a}changeAnimation(){this.currentFrame=this.currentFrame==this.frameCount?1:this.currentFrame+1}draw(){canvasContext.save(),canvasContext.translate(this.x+oneBlockSize/2,this.y+oneBlockSize/2),canvasContext.rotate(90*this.direction*Math.PI/180),canvasContext.translate(-this.x-oneBlockSize/2,-this.y-oneBlockSize/2),canvasContext.drawImage(pacmanFrames,(this.currentFrame-1)*oneBlockSize,0,oneBlockSize,oneBlockSize,this.x,this.y,this.width,this.height),canvasContext.restore()}}